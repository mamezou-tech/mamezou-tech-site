---
title: ペアワイズ法テストケース生成ツール「PictMaster」の原型シートを使う(水準編)
author: shuichi-takatsu
date: 2023-01-06
tags: [テスト, pairwise, pict, pictmaster]
---

[前回](/blogs/2022/11/27/pictmaster-coverage-option/)はペアワイズ法テストケース生成ツール「PictMaster」の”カバレッジ指定”機能について紹介しました。  
今回はPictMasterの”原型シート”機能について紹介したいと思います。


## 既存のテストケースを再利用する

ペアワイズ法を使えば複数の因子・水準からテストケースを効率よく生成できますが、網羅すればするほどテスト実行には時間も労力もかかります。  
テスト対象の一部が変更になった場合に、”変更になった部分だけ”を追加でテストするテストケースを生成したい場合があります。  

以下の例で考えてみましょう。  

因子が a, b, c の３個で、それぞれが２水準の値を持っている場合を想定します。  

![](https://gyazo.com/1ac63ad50690305e5460ea119f592e19.png)

２因子間網羅のテストケースは以下のようになりました。  
テストケース数は合計４個でした。  

![](https://gyazo.com/4949c93feb007c0e0726d58f31c7caa5.png)

次に、因子c の水準に値が１つ増えて３水準になった場合を考えてみます。  
(テストを実行していると、水準の追加は意外と発生すると思います)

![](https://gyazo.com/f2a6d6babffe8bd6ccb06a5032e6078b.png)

これまで通りの方法で２因子間網羅のテストケースを生成します。  
生成されたテストケースは以下のようになりました。  
テストケース数は合計７個でした。  

![](https://gyazo.com/33a31b46dcea398bce0b367c38ddd56c.png)

テストケースは生成できましたが、因子cに水準を一つ追加しただけなのに、組み合わせのパターンはかなり変わってしまいました。  
最初のテストケース群に登場していた  
`a1, b2, c1`  
の組み合わせは次のテストケース群には登場していません。  
最初からテストのやり直しになってしまいます。

## 原型シートを使用して、既存テストケースに差分を追加する

テスト回数をできるだけ減らすために、最初に生成した４つのテストケースをそのまま流用して、追加のテストケースを生成してみましょう。

「環境設定」にて、「原型シートを使用」にチェックを入れて「OK」を押します。

![](https://gyazo.com/4e21a480d1bc750253df1e54e7d9ca73.png)

因子・水準を定義したシートの右隣に新しいシートを作成します。  
(PictMasterの規約で、必ず右隣に新しいシートを作成する必要があります)

![](https://gyazo.com/de8c9ce481f61a4606daa9da4c464331.png)

作成した新しいシート(Sheet2)に、先に生成したテストケースをコピーしておきます。

![](https://gyazo.com/77a84ecd5e56bfb4001c6a1bd335b78d.png)

原型シートを使用して２因子間網羅のテストケースを生成します。  
生成されたテストケースは以下のようになりました。  
テストケース数は合計６個でした。  

![](https://gyazo.com/4142538526f1ad9674a42b165abc10bd.png)

原型シートを使用しない場合のテストケース数は７個でしたが、今回は６個になっています。  
もう一つの違いとして、テストケースの上位４個と、原型シートに記述したテストケース４個と比べてみます。

![](https://gyazo.com/dcdd99fe82bd3fa54177a445a4d3833e.png)

今回生成したテストケース６個のうち、上位の４個(上図の赤字で示した部分)は原型シートに記述したテストケースと同じものになっているのがわかると思います。  

このように、原型シートを使用すると既存のテストケースを流用しつつ、変更部分のみの新しいテストケースを追加生成することができます。  
テスト環境の作成や、テストの実行時間を大幅に短縮することが可能になります。  
(今回は水準のみ追加しましたが、因子を追加することも出来ます。方法はまた別の機会にご説明します)

## まとめ

「原型シート」機能を使うことによって、既存のテストケースを流用して、変更分のみのテストケースを追加生成することができました。  
PICTには他にも色々なオプションが用意されていて、PictMasterから利用可能です。  
次回も別のオプションを紹介していきたいと思います。

[ソフトウェアテストに関する技法やテクニックをまとめています。](/testing/)

テストに活用していただければ幸いです。
