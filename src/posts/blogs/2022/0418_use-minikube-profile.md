---
title: Minikube ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ã„ã“ãªã™
author: masahiro-kondo
date: 2022-04-18
---

Minikube ã‚’ä½¿ã£ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚¢ãƒ—ãƒªã‚’é–‹ç™ºã—ã¦ã‚‹ã¨ã€ç›®çš„åˆ¥ã«ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ä½¿ã„ãŸããªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

- ãµã ã‚“ã‚¢ãƒ—ãƒªé–‹ç™ºã«ä½¿ã£ã¦ã„ã‚‹ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨åˆ¥ã®ã‚¯ãƒªãƒ¼ãƒ³ãªã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã§ä½œæ¥­ã‚’ã—ãŸã„
- ç‰¹å®šã® kubernetes ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’ä½¿ã„ãŸã„
- Docker ä»¥å¤–ã®ã‚³ãƒ³ãƒ†ãƒŠãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’ä½¿ã„ãŸã„

ãªã©ã€‚Minikube ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ `minikube` ã¨ã„ã†ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’èµ·å‹•ã—ã¾ã™ã€‚minikube profile ã‚³ãƒãƒ³ãƒ‰ã§ã€ç¾åœ¨ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åã‚„èµ·å‹•æ§‹æˆã‚’ç¢ºèªã§ãã¾ã™ã€‚

```shell
$ minikube profile
minikube
$ minikube profile list
|----------|-----------|---------|--------------|------|---------|---------|-------|
| Profile  | VM Driver | Runtime |      IP      | Port | Version | Status  | Nodes |
|----------|-----------|---------|--------------|------|---------|---------|-------|
| minikube | hyperkit  | docker  | 192.168.64.8 | 8443 | v1.22.2 | Running |     1 |
|----------|-----------|---------|--------------|------|---------|---------|-------|
```

Minikube ã§ã¯ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã— start ã™ã‚‹ã“ã¨ã§ç•°ãªã‚‹ç’°å¢ƒã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’èµ·å‹•ã§ãã¾ã™ã€‚

æ–°ã—ã„ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« `hoge` ã§ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’ä½œæˆã™ã‚‹ã«ã¯ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã—ã¦ minikube start ã—ã¾ã™ã€‚ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ§‹æˆ[^1] ã‚’å¼•ãç¶™ã„ã§èµ·å‹•ã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€kubernetes ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ v1.23.3 ã‚’æŒ‡å®šã—ã¦èµ·å‹•ã—ã¦ã„ã¾ã™ã€‚

[^1]: æœ¬è¨˜äº‹ã§ä½¿ç”¨ã—ãŸç’°å¢ƒã¯ macOS ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸ Minikube v1.25.2 ã§ã™ã€‚minikube config ã§ driver `hyperkit` ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚

```shell
$ minikube start -p hoge --kubernetes-version=v1.23.3
ğŸ˜„  Darwin 12.3.1 ä¸Šã® [hoge] minikube v1.25.2
âœ¨  ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨­å®šã«åŸºã¥ã„ã¦ hyperkit ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã™
ğŸ‘  hoge ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ä¸­ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã® hoge ãƒãƒ¼ãƒ‰ã‚’èµ·å‹•ã—ã¦ã„ã¾ã™
ğŸ”¥  hyperkit VM (CPUs=2, Memory=4096MB, Disk=20000MB) ã‚’ä½œæˆã—ã¦ã„ã¾ã™...
ğŸ³  Docker 20.10.12 ã§ Kubernetes v1.23.3 ã‚’æº–å‚™ã—ã¦ã„ã¾ã™...
    â–ª kubelet.housekeeping-interval=5m
    â–ª è¨¼æ˜æ›¸ã¨éµã‚’ä½œæˆã—ã¦ã„ã¾ã™...
    â–ª ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã‚’èµ·å‹•ã—ã¦ã„ã¾ã™...
    â–ª RBAC ã®ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šä¸­ã§ã™...
ğŸ”  Kubernetes ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ¤œè¨¼ã—ã¦ã„ã¾ã™...
    â–ª gcr.io/k8s-minikube/storage-provisioner:v5 ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™
ğŸŒŸ  æœ‰åŠ¹ãªã‚¢ãƒ‰ã‚ªãƒ³: storage-provisioner, default-storageclass
ğŸ„  å®Œäº†ã—ã¾ã—ãŸï¼ kubectl ãŒã€Œ"hoge"ã€ã‚¯ãƒ©ã‚¹ã‚¿ã¨ã€Œ"default"ã€ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†æ§‹æˆã•ã‚Œã¾ã—ãŸ
```

hoge ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãŒèµ·å‹•ã•ã‚Œã€kubernetes ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæŒ‡å®šé€šã‚Šã® v1.23.3 ã«ãªã£ã¦ã„ã¾ã™ã€‚

```shell
$ minikube profile list 
|----------|-----------|---------|---------------|------|---------|---------|-------|
| Profile  | VM Driver | Runtime |      IP       | Port | Version | Status  | Nodes |
|----------|-----------|---------|---------------|------|---------|---------|-------|
| hoge     | hyperkit  | docker  | 192.168.64.11 | 8443 | v1.23.3 | Running |     1 |
| minikube | hyperkit  | docker  | 192.168.64.8  | 8443 | v1.22.2 | Stopped |     1 |
|----------|-----------|---------|---------------|------|---------|---------|-------|
```

ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼èµ·å‹•æ™‚ã«ã€kubectl ã® config ã¯ hoge ã‚’æŒ‡ã™ã‚ˆã†ã«æ§‹æˆã•ã‚Œã¾ã™ãŒã€Minikube ã®ã‚«ãƒ¬ãƒ³ãƒˆãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€minikube ã®ã¾ã¾ã§ã™ã€‚åˆ‡ã‚Šæ›¿ãˆã‚‹ã«ã¯ profile ã‚³ãƒãƒ³ãƒ‰ã§ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã—ã¾ã™ã€‚

```shell
$ minikube profile hoge
âœ…  ç„¡äº‹ minikube ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãŒ hoge ã«è¨­å®šã•ã‚Œã¾ã—ãŸ
```

ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« hoge ã®ã‚³ãƒ³ãƒ†ãƒŠãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã« containerd ã‚’æŒ‡å®šã—ãŸã„å ´åˆã¯ã€start ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æŒ‡å®šã—ã¾ã™ã€‚

:::info:minikube config ã¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
minikube config ã‚³ãƒãƒ³ãƒ‰ã§æŒ‡å®šã™ã‚‹èµ·å‹•æ§‹æˆã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§ã™ã€‚ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã”ã¨ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯æŒ‡å®šã§ãã¾ã›ã‚“ã€‚
:::

ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« hoge ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’ã‚³ãƒ³ãƒ†ãƒŠãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’æŒ‡å®šã›ãšã«èµ·å‹•ã—ãŸã®ã§ã€åŒã˜ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åã§èµ·å‹•æ§‹æˆã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ä¸€åº¦ã“ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚«ãƒ¬ãƒ³ãƒˆã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãŒ hoge ã«åˆ‡ã‚Šæ›¿ã‚ã£ã¦ã„ãªã„å ´åˆ stop ã‚„ start ã§ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```shell
$ minikube stop -p hoge
âœ‹  ã€Œhogeã€ãƒãƒ¼ãƒ‰ã‚’åœæ­¢ã—ã¦ã„ã¾ã™...
ğŸ›‘  1 å°ã®ãƒãƒ¼ãƒ‰ãŒåœæ­¢ã—ã¾ã—ãŸã€‚

$ minikube delete -p hoge 
ğŸ”¥  hyperkit ã®ã€Œhogeã€ã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™...
ğŸ’€  ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã€Œhogeã€ã®å…¨ã¦ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚
```
:::alert
ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‹ã‚‰åˆ‡ã‚Šæ›¿ãˆãšã«ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç„¡æŒ‡å®šã§ delete ã™ã‚‹ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãŒå‰Šé™¤ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚delete ã™ã‚‹ã¨ãã¯å¸¸ã«ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹æ–¹ãŒå®‰å…¨ã§ã™ã€‚
:::

hoge ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹ã¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ(minikube)ã«æˆ»ã‚Šã¾ã™ã€‚

ãã‚Œã§ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã« containerd ã‚’æŒ‡å®šã—ã¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« hoge ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’èµ·å‹•ã—ã¾ã™ã€‚

```shell
$ minikube start -p hoge --container-runtime=containerd --kubernetes-version=v1.23.3
ğŸ˜„  Darwin 12.3.1 ä¸Šã® [hoge] minikube v1.25.2
âœ¨  ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨­å®šã«åŸºã¥ã„ã¦ hyperkit ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã™
ğŸ‘  hoge ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ä¸­ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã® hoge ãƒãƒ¼ãƒ‰ã‚’èµ·å‹•ã—ã¦ã„ã¾ã™
ğŸ’¾  Kubernetes v1.23.3 ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®æº–å‚™ã‚’ã—ã¦ã„ã¾ã™
    > preloaded-images-k8s-v17-v1...: 572.66 MiB / 572.66 MiB  100.00% 8.63 MiB
ğŸ”¥  hyperkit VM (CPUs=2, Memory=4096MB, Disk=20000MB) ã‚’ä½œæˆã—ã¦ã„ã¾ã™...
ğŸ“¦  containerd 1.4.12 ã§ Kubernetes v1.23.3 ã‚’æº–å‚™ã—ã¦ã„ã¾ã™...
    â–ª kubelet.housekeeping-interval=5m
    â–ª è¨¼æ˜æ›¸ã¨éµã‚’ä½œæˆã—ã¦ã„ã¾ã™...
    â–ª ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã‚’èµ·å‹•ã—ã¦ã„ã¾ã™...
    â–ª RBAC ã®ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šä¸­ã§ã™...
ğŸ”—  bridge CNI (ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹) ã‚’è¨­å®šä¸­ã§ã™...
ğŸ”  Kubernetes ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ¤œè¨¼ã—ã¦ã„ã¾ã™...
    â–ª gcr.io/k8s-minikube/storage-provisioner:v5 ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™
ğŸŒŸ  æœ‰åŠ¹ãªã‚¢ãƒ‰ã‚ªãƒ³: default-storageclass, storage-provisioner
ğŸ„  å®Œäº†ã—ã¾ã—ãŸï¼ kubectl ãŒã€Œ"hoge"ã€ã‚¯ãƒ©ã‚¹ã‚¿ã¨ã€Œ"default"ã€ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†æ§‹æˆã•ã‚Œã¾ã—ãŸ
```

èµ·å‹•æ§‹æˆã® Runtime ãŒ hoge ã¨ minikube ã§å¤‰ã‚ã£ã¦ã„ã¾ã™ã€‚

```shell
$ minikube profile list
|----------|-----------|------------|---------------|------|---------|---------|-------|
| Profile  | VM Driver |  Runtime   |      IP       | Port | Version | Status  | Nodes |
|----------|-----------|------------|---------------|------|---------|---------|-------|
| hoge     | hyperkit  | containerd | 192.168.64.12 | 8443 | v1.23.3 | Running |     1 |
| minikube | hyperkit  | docker     | 192.168.64.8  | 8443 | v1.22.2 | Stopped |     1 |
|----------|-----------|------------|---------------|------|---------|---------|-------|
```

ä»¥ä¸Šã®ã‚ˆã†ã« Minikube ã«ãŠã‘ã‚‹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨ã»ã¼åŒç¾©ã§ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨åŒã˜ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’æŒã¡ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’å‰Šé™¤ã—ãŸã¨ãã«å‰Šé™¤ã•ã‚Œã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ç•°ãªã‚‹èµ·å‹•æ§‹æˆã§æ–°è¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’èµ·å‹•ã—ãŸã„å ´åˆã¯ start ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æŒ‡å®šã—ã¾ã™ã€‚
