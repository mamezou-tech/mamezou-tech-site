---
title: 直感が理性に大反抗！「モンティ・ホール問題」
author: shuichi-takatsu
date: 2022-07-04
tags: [Analytics]
---

人生は選択の連続です。  
選択を迫られたとき何を根拠にして選んでいるでしょうか。  
直感を信じるか、理性を信じるか。  
人によって重視するものは違うと思います。

今回は多くの数学者を巻き込んで大論争になった「モンティ・ホール問題」を取り上げてみたいと思います。


## モンティ・ホール問題とは

「モンティ・ホール問題」は、ベイズの定理における事後確率（主観確率）の例題として良く引用されます。  
内容としては確率論の問題なのですが、「モンティ・ホール問題」の名前はアメリカのゲームショーに由来します。  
そのゲームショーの司会者が「モンティ・ホール」という人物でした。  
問題となったゲームの内容は以下のような簡単なものです。  

ゲームには１人のプレーヤと、司会者兼進行役のモンティが登場します。
彼らの目の前にはドアが３つ置かれていて、３つのドア後ろには”当たり景品”である高級車１台と”ハズレ景品”であるヤギ２匹がランダムに置かれています。  
プレーヤは当たり景品が隠されているドアを見事に言い当てて高級車をゲットしたい訳です。

ゲームは以下のように進められます。  
(1) ３つのドアの後ろには、高級車１台、ヤギ２匹がランダムに配置されます。  
(2) プレーヤが３つのドアのうちの１つを選びます。  
(3) モンティが残りのドアのうちの１つを選んでドアを開けます。ただし、モンティには”当たり”のドアが分かっていて、モンティは”必ず”ハズレのドア(ヤギの居るドア)を開けます。  
(4) モンティはプレーヤに「ドアを選びなおしても良いです」と言います。

問題とは、プレーヤはドアを選びなおした方が良いのだろうか？それとも最初に選んだドアのままでいた方が良いのだろうか？と言うものです。

## 問題の発端

大論争の発端はマリリン・ボス・サヴァントという人が自身が持つコラム「マリリンにおまかせ」にて、読者投稿の質問に答える形で

`”ドアを選びなおす”が正解である。当たり景品を当てる確率は、ドアを選びなおした場合が選びなおさなかった場合の2倍になる`

と回答したことに端を発します。  
すると「サヴァントの解答は間違っている」という投稿が殺到し、大論争に発展したのです。  
論争に参加した人の中には数学者もいて、かなり揉めたようです。

## 直感が理性に反抗する

答えを先に言ってしまうと「プレーヤがドアを選びなおすと当たり景品を得る確率が上がる」が正解です。  
そうです！サヴァントさんの言う通りだったのです。  
しかし、正解を聞いても正直に”ああ、そうなんだ”と納得することができないことから大論争になった訳です。

ここからの議論にはドアに名称が無いと説明が大変なので、それぞれのドアを
- ドアA  
- ドアB  
- ドアC

としましょう。

最初にドアAを選んだときドアAが当たりである確率は$1 \over 3$ですが、モンティがドアBを開けた後にプレーヤがドアCを選びなおすと当たる確率が$2 \over 3$になります。  

多くの人が「モンティがドアBを開けた後の選択可能なドアは２つのみであり、その片方を選べるのだから二者択一問題だ。よって当たる確率は$1 \over 2$だ」と考えるのは無理もないことだと思います。  

私も何の知識も無かったらそう思っていたでしょう。
しかし、計算すると”ドアを選びなおした方が$2 \over 3$の確率で当たる”となるのです。

多くの人が持っている”直感”に計算結果が逆らう結果になり、全米を巻き込んだ(言い過ぎか)大論争に発展したのです。

## 直感に挑戦！ドアの数を１０個にしてみる

ドアの数が３個しかないと、残されたドアのどちらを選ぶかの二者択一になってしまうので、ドアの数を１０個にして改めて考えてみます。  

先ほどの条件との違いは  
「モンティが残りのドアのうちの１つを選んでドアを開ける」  
から  
「モンティが残りのドアのうちの１つを除いて、他のドアを全部開ける」  
になることです。  
モンティがドアを開けるときの制約「開けるドアは必ずハズレのドアである」は変更ありません。

ドアが１０個だった場合、プレーヤがドアAを選び、モンティはドアB,C,D,E,F,G,H,I,Jのうちの１つを残して、残りのドア８個を開けます。  
そうしてモンティは「さあ、ドアを選びなおしますか？」と聞くのです。  
この状況では、ドアを選びなおさなかった場合の当たる確率は$1 \over 10$のままですが、モンティの行動によって残りの9個の選択肢が1個の選択肢にまで絞られている状況になるので、選びなおした方が確率が上がりそうな感じがします。

## 全パターンを網羅

直感で考えないで、全パターンで考えてみましょう。

ただし、
- プレーヤがドアAを選ぶ。
- モンティがハズレのドアを開ける。

の動作は固定して考えます。  
当たり景品が配置されているドアをA,B,Cと順番に変更した場合を考えます。

高級車（当たり景品）とヤギ（ハズレ景品）の配置のパターンは以下の３つしかありません。

|    | ドアA | ドアB | ドアC |
|:---:|:---:|:---:|:---:|
|パターン１| 高級車 | ヤギ | ヤギ |
|パターン２| ヤギ | 高級車 | ヤギ |
|パターン３| ヤギ | ヤギ | 高級車 |

パターン１でプレーヤがAを選んだ時、モンティはBまたはCのドアを選べます。
この場合、プレーヤがドアを選びなおすと「ハズレ」、選びなおさないと「当たり」になります。

パターン２でプレーヤがAを選んだ時、モンティはCのドアしか選べません（モンティは必ずハズレを引くので）。
この場合、プレーヤがドアを選びなおすと「当たり」、選びなおさないと「ハズレ」になります。

パターン３でプレーヤがAを選んだ時、モンティはBのドアしか選べません（モンティは必ずハズレを引くので）。
この場合、プレーヤがドアを選びなおすと「当たり」、選びなおさないと「ハズレ」になります。

つまり、上記のパターンから考えて  
|    | 当たり | ハズレ |
|:---:|:---:|:---:|
|ドアを選びなおす| $2 \over 3$ | $1 \over 3$ |
|ドアを選びなおさない| $1 \over 3$ | $2 \over 3$ |

このようにモンティが”必ず”ハズレのドアを開けるという動作が間に入ることによって、「ドアを選びなおす」の方が「ドアを選びなおさない」より２倍も有利になるのです。

## ベイズの定理で解く

これまでも何度か登場した[ベイズの定理](/blogs/2022/06/07/bayes-theorem)で問題を解いてみましょう。    
ベイズの定理の式は

$P(X|Y)$ = $P(Y|X)P(X) \over P(Y)$

です。

それぞれのドアが当たりの確率を以下のように置きます。  

$P(A) = {1 \over 3}$  
$P(B) = {1 \over 3}$  
$P(C) = {1 \over 3}$

事前の情報が何も無いので、$P(A)$,$P(B)$,$P(C)$の確率はすべて同じです。

プレーヤがドアAを選んで、モンティがドアBを開けたとしましょう。  
次にプレーヤが取れる選択肢は  
- ドアAのままとする
- ドアCを選びなおす

の２択です。

最初に求めたい確率P(A|B）は「プレーヤがドアAを選び、モンティがドアBを開けたときに、ドアAが当たりである確率」です。

ベイズの式を

$P(A|B)$ = $P(B|A)P(A) \over P(B)$

とします。

では、右辺の式のそれぞれの値を考えましょう。  

P(B|A)は「ドアAが当たりであるとき、モンティがドアBを開ける確率」です。  
Aが当たりの場合はモンティはBまたはCのどちらのドアを開けても良いので、確率は $1 \over 2$ です。

P(A)は「ドアAが当たりである」という事前確率です。確率は $1 \over 3$ です。

P(B)は事前条件なしに「モンティがドアBを開ける確率」です。  
モンティはBまたはCのどちらのドアを開けても良いので、確率は $1 \over 2$ です。    
（事前条件なしとは言っても、モンティがドアを開けるタイミングは”必ず”プレーヤがドアを選んだ後のことなので、取り得る場合の数としては２択になります）

上記を計算すると「プレーヤがドアAを選び、モンティがドアBを開けたとき、ドアAが当たりである確率」$P(A|B)$は $1 \over 3$ になります。

次に求めたい確率P(C|B）は「プレーヤがドアAを選び、モンティがドアBを開けたときに、ドアCが当たりである確率」です。

ベイズの式を

$P(C|B)$ = $P(B|C)P(C) \over P(B)$

とします。

では、右辺の式のそれぞれの値を考えましょう。 

P(B|C)は「ドアCが当たりであるとき、モンティがドアBを開ける確率」です。   
Cが当たりの場合、モンティにはBしか選択の余地がない(ドアAはプレーヤが選んでいる)ので、確率は1です。

P(C)は「ドアCが当たりである」という事前確率です。確率は $1 \over 3$ です。 

P(B)は事前条件なしに「モンティがドアBを開ける確率」です。  
モンティはBまたはCのどちらのドアを開けても良いので、確率は $1 \over 2$ です。    
（事前条件なしとは言っても、モンティがドアを開けるタイミングは”必ず”プレーヤがドアを選んだ後のことなので、取り得る場合の数としては２択になります）

上記を計算すると「プレーヤがドアAを選び、モンティがドアBを開けたとき、ドアCが当たりである確率」$P(C|B)$は $2 \over 3$ です。

モンティが開けるドアをBからCに変更して「プレーヤがドアAを選び、モンティがドアCを開けたときに、ドアAが当たりである確率」と「プレーヤがドアAを選び、モンティがドアCを開けたときに、ドアBが当たりである確率」として計算しても結果は同じになります。

つまり、当たる確率は「ドアを選びなおした場合」が「選びなおさなかった場合」の２倍になるのです。

## なんでこんなに大騒動に？

多くの数学者まで巻き込んだ今回の大騒動の原因は、モンティの番組をいつも見ている視聴者には周知であった”暗黙の”ルールを、批判した人々の多くが知らなかったことだ、と言われています。  
最初に正解を言い当てたサヴァントさんへの個人攻撃にもエスカレートして問題にもなったようです。

## まとめ

本問題はパラドックスではなく、確率的に矛盾はありません。  
多くの人が持つ”直感”が理性に激しく抵抗する問題として、ベイズの定理の奥深さを理解させてくれる良い例題になっています。  
直感が有効な場合もありますが、まず冷静に物事を判断したいものです。

[統計解析ツール紹介やその活用方法をまとめています。](https://developer.mamezou-tech.com/analytics/)

データ分析に活用して頂ければ幸いです。
